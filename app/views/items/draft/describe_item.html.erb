<% page_title( t('.header')) %>

<%= render partial: 'progress_bar' %>

<h2 class="mt-3">
  <%= fa_icon t('.header_icon') %>
  <%= t('.header') %>
</h2>

<%= form_for @draft_item, url: wizard_path, method: :put, html: { class:'js-deposit-item' } do |f| %>
  <p class="text-muted"><%= t('required_fields_html') %></p>

  <div class="form-group">
    <%= f.label :title do %>
      <span class="text-danger">*</span>
      <%= t('.title') %>
    <% end %>
    <%= f.text_field :title,
                      class: 'form-control',
                      placeholder: t('.title_placeholder') %>
  </div>

  <div class="form-group">
    <%= f.label :alternate_title, t('.alternate_title') %>
    <%= f.text_field :alternate_title,
                      class: 'form-control',
                      placeholder: t('.alternate_title_placeholder') %>
    <small class="form-text text-muted"><%= t('.alternate_title_help') %></small>
  </div>

  <div class="form-group">
    <%= f.label :type_id do %>
      <span class="text-danger">*</span>
      <%= t('.type_id') %>
    <% end %>
    <%= f.collection_select :type_id,
                            Type.all,
                            :id,
                            :translated_name,
                            {},
                            class: 'form-control' %>
    <small class="form-text text-muted">
      <%= t('.type_id_help_html') %>
    </small>
  </div>

  <div class="form-group">
    <%= f.label :languages do %>
      <span class="text-danger">*</span>
      <%= t('.languages') %>
    <% end %>
    <%= f.collection_select :languages,
                            Language.all,
                            :id,
                            :translated_name,
                            {},
                            multiple: true,
                            data: { placeholder: t('.languages_placeholder') },
                            class: 'form-control js-select2' %>
  </div>

  <div class="form-group">
    <%= f.label :creators do %>
      <span class="text-danger">*</span>
      <%= t('.creators') %>
    <% end %>
    <%= f.collection_select :creators,
                            Creator.all,
                            :id,
                            :name,
                            {},
                            multiple: true,
                            data: { placeholder: t('.creators_placeholder') },
                            class: 'form-control js-select2' %>
    <small class="form-text text-muted"><%= t('.creators_help') %></small>
  </div>

  <div class="form-group">
    <%= f.label :subject do %>
      <span class="text-danger">*</span>
      <%= t('.subjects') %>
    <% end %>
    <%= f.collection_select :subjects,
                            Subject.all,
                            :id,
                            :name,
                            {},
                            multiple: true,
                            data: { placeholder: t('.subjects_placeholder') },
                            class: 'form-control js-select2' %>
    <small class="form-text text-muted"><%= t('.subjects_help') %></small>
  </div>

  <div class="form-group">
    <%= f.label :date_created do %>
      <span class="text-danger">*</span>
      <%= t('.date_created') %>
    <% end %>
    <div class="d-md-flex justify-content-between">
        <%= f.date_select :date_created,
                          { order: [:year, :month, :day],
                            prompt: { day: t('select_a_day'),
                                      month: t('select_a_month'),
                                      year: t('select_a_year')
                                    },
                            start_year: Date.today.year - 100,
                            end_year: Date.today.year + 1
                          }, { class: 'form-control  mr-2 mb-2' } %>
    </div>
  </div>

  <div class="form-group">
    <%= f.label :description do %>
      <span class="text-danger">*</span>
      <%= t('.description') %>
    <% end %>
    <%= f.text_area :description,
                    size: '25x10',
                    class: 'form-control',
                    placeholder: t('.description_placeholder') %>
  </div>

  <fieldset>
    <legend class="mb-0">
      <span class="text-danger">*</span>
      <%= t('.community_and_collection') %>
    </legend>
    <small class="mb-3 form-text text-muted">
      <%= t('.community_and_collection_help_html') %>
    </small>
    <div class="form-group">
      <label><%= t('.community') %></label>
      <%= select_tag 'draft_item[community_id]',
                      options_from_collection_for_select(Community.all, :id, :title),
                      prompt: t('.community_placeholder'),
                      class: 'form-control js-community-select' %>
    </div>
    <div class="form-group">
      <label><%= t('.collection') %></label>
      <%= select_tag 'draft_item[collection_id]',
                      nil,
                      data: { placeholder: t('.collection_placeholder') },
                      class: 'form-control js-collection-select',
                      disabled: true %>
    </div>
  </fieldset>

  <div id="js-additional-fields-accordion" role="tablist">
    <div class="card">
      <div id="js-heading-additional-fields" class="card-header" role="tab">
        <h5 class="mb-0">
          <a data-toggle="collapse"
              href="#js-collapse-additional-fields"
              aria-expanded="false"
              aria-controls="js-collapse-additional-fields">
            <%= t('.additional_fields') %>
            <%= fa_icon "chevron-down", class: "js-more-less pull-right" %>
          </a>
        </h5>
      </div>

      <div id="js-collapse-additional-fields"
            class="collapse"
            data-parent="#js-additional-fields-accordion"
            role="tabpanel"
            aria-labelledby="js-heading-additional-fields">
        <div class="card-body">
          <div class="form-group">
            <%= f.label 'contributors', t('.contributors') %>
            <%= f.select 'contributors',
                          {},
                            multiple: true,
                            data: { tags: true,
                                    placeholder: t('.contributors_placeholder') },
                            class: 'form-control js-select2' %>
            <small class="form-text text-muted"><%= t('.contributors_help') %></small>
          </div>

          <div class="form-group">
            <%= f.label 'places', t('.places') %>
            <%= f.select 'places',
                          {},
                            multiple: true,
                            data: { tags: true,
                                    placeholder: t('.places_placeholder') },
                            class: 'form-control js-select2' %>
            <small class="form-text text-muted"><%= t('.places_help') %></small>
          </div>

          <div class="form-group">
            <%= f.label 'time_periods', t('.time_periods') %>
            <%= f.select 'time_periods',
                          {},
                            multiple: true,
                            data: { tags: true,
                                    placeholder: t('.time_periods_placeholder') },
                            class: 'form-control js-select2' %>
            <small class="form-text text-muted"><%= t('.time_periods_help_html') %></small>
          </div>

          <div class="form-group">
            <%= f.label 'citations', t('.citations') %>
            <%= f.select 'citations',
                          {},
                            multiple: true,
                            data: { tags: true,
                                    placeholder: t('.citations_placeholder') },
                            class: 'form-control js-select2' %>
            <small class="form-text text-muted"><%= t('.citations_help') %></small>
          </div>

          <div class="form-group">
            <%= f.label 'source', t('.source') %>
            <%= f.text_field 'source', class: 'form-control' %>
            <small class="form-text text-muted"><%= t('.source_help') %></small>
          </div>

          <div class="form-group">
            <%= f.label 'related_item', t('.related_item') %>
            <%= f.text_field 'related_item', class: 'form-control' %>
            <small class="form-text text-muted"><%= t('.related_item_help') %></small>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="mt-3 pull-right">
    <%= link_to root_path, class: 'btn btn-secondary' do %>
      <%= fa_icon 'ban' %>
      <%= t('cancel') %>
    <% end %>
    <%= f.button type: :submit, class: 'btn btn-primary' do %>
      <%= t('items.draft.save_and_continue') %>
      <%= fa_icon 'chevron-right' %>
    <% end %>
  </div>

<% end %>
