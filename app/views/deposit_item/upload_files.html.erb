<% page_title( t('.header')) %>

<%= render partial: 'progress_bar' %>

<h2 class="mt-3"><%= t('.header') %></h2>

<%# TODO: Need to figure out data model and migrate everything to use form_for and it's helpers
= form_for @item, url: wizard_path, method: :put, class:'js-deposit-item' do |f| %>
<%= form_tag wizard_path, method: :put, multipart: true, class:'js-deposit-item js-dropzone' do %>
  <div class="row">
    <div class="col">
      <!-- The fileinput-button span is used to style the file input field as button -->
      <button type="button" class="btn btn-primary js-add-files">
        <%= fa_icon 'plus' %>
        Add files
      </button>
      <button type="reset" class="btn btn-secondary js-cancel-files">
        <%= fa_icon 'minus' %>
        Remove files
      </button>
    </div>
  </div>

  <ul class="list-unstyled js-files" id="previews">
    <li id="template" class="media my-3 p-3 border file-row">
      <!-- This is used as the file preview template -->
      <img data-dz-thumbnail class="mr-3">
      <div class="media-body">
        <div class="pull-right">
          <button type="button" data-dz-remove class="btn btn-secondary">
              <%= fa_icon 'minus' %>
              <span>Remove</span>
          </button>
        </div>
        <h5 class="mt-0 mb-1" class="name" data-dz-name></h5>
        <strong class="error text-danger" data-dz-errormessage></strong>
        <p class="size" data-dz-size></p>
        <div class="progress">
          <div class="progress-bar progress-bar-striped bg-success progress-bar-animated" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"  data-dz-uploadprogress></div>
        </div>

      </div>
    </li>
  </ul>

  <div class="form-group fallback">
    <%= file_field_tag 'files', multiple: true, class: 'form-control-file' %>
  </div>

  <div class="mt-3 pull-right">
    <%= link_to previous_wizard_path, class: 'btn btn-secondary' do %>
      <%= fa_icon 'chevron-left' %>
      <%= t('deposit_item.previous') %>
    <% end %>
    <%= button_tag type: :submit, class: 'btn btn-primary' do %>
      <%= t('deposit_item.save_and_continue') %>
      <%= fa_icon 'chevron-right' %>
    <% end %>
  </div>
<% end %>
